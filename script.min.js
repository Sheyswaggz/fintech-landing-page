(function(){'use strict';if(!('querySelector'in document)){return;}const CONFIG={EMAIL_REGEX:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,ERROR_CLASS:'form-error',SUCCESS_CLASS:'form-success',ACTIVE_CLASS:'active',ANALYTICS_KEY:'fintech_analytics',SCROLL_BEHAVIOR:'smooth',SCROLL_OFFSET:80};const state={eventListeners:[],isMenuOpen:false};function init(){try{initSmoothScroll();initMobileMenu();initFormValidation();initAnalytics();logEvent('page_view',{timestamp:Date.now()});}catch(error){console.error('Initialization error:',error);}}function initSmoothScroll(){const anchorLinks=document.querySelectorAll('a[href^="#"]');anchorLinks.forEach(link=>{const handler=handleSmoothScroll.bind(null,link);link.addEventListener('click',handler);state.eventListeners.push({element:link,event:'click',handler});});}function handleSmoothScroll(link,event){const href=link.getAttribute('href');if(!href||href==='#'){return;}const targetId=href.substring(1);const targetElement=document.getElementById(targetId);if(!targetElement){return;}event.preventDefault();if('scrollBehavior'in document.documentElement.style){targetElement.scrollIntoView({behavior:CONFIG.SCROLL_BEHAVIOR,block:'start'});}else{const targetPosition=targetElement.getBoundingClientRect().top+window.pageYOffset-CONFIG.SCROLL_OFFSET;window.scrollTo({top:targetPosition,behavior:CONFIG.SCROLL_BEHAVIOR});}if(history.pushState){history.pushState(null,null,href);}logEvent('navigation_click',{target:targetId});}function initMobileMenu(){const menuToggle=document.querySelector('.menu-toggle');const navigation=document.querySelector('.header__menu');if(!menuToggle||!navigation){return;}const handler=handleMenuToggle.bind(null,menuToggle,navigation);menuToggle.addEventListener('click',handler);state.eventListeners.push({element:menuToggle,event:'click',handler});const escapeHandler=handleMenuEscape.bind(null,menuToggle,navigation);document.addEventListener('keydown',escapeHandler);state.eventListeners.push({element:document,event:'keydown',handler:escapeHandler});const outsideClickHandler=handleOutsideClick.bind(null,menuToggle,navigation);document.addEventListener('click',outsideClickHandler);state.eventListeners.push({element:document,event:'click',handler:outsideClickHandler});}function handleMenuToggle(toggle,navigation,event){event.stopPropagation();state.isMenuOpen=!state.isMenuOpen;toggle.classList.toggle(CONFIG.ACTIVE_CLASS);navigation.classList.toggle(CONFIG.ACTIVE_CLASS);toggle.setAttribute('aria-expanded',state.isMenuOpen);navigation.setAttribute('aria-hidden',!state.isMenuOpen);logEvent('menu_toggle',{open:state.isMenuOpen});}function handleMenuEscape(toggle,navigation,event){if(event.key==='Escape'&&state.isMenuOpen){state.isMenuOpen=false;toggle.classList.remove(CONFIG.ACTIVE_CLASS);navigation.classList.remove(CONFIG.ACTIVE_CLASS);toggle.setAttribute('aria-expanded','false');navigation.setAttribute('aria-hidden','true');}}function handleOutsideClick(toggle,navigation,event){if(state.isMenuOpen&&!navigation.contains(event.target)&&!toggle.contains(event.target)){state.isMenuOpen=false;toggle.classList.remove(CONFIG.ACTIVE_CLASS);navigation.classList.remove(CONFIG.ACTIVE_CLASS);toggle.setAttribute('aria-expanded','false');navigation.setAttribute('aria-hidden','true');}}function initFormValidation(){const form=document.querySelector('.cta__form');if(!form){return;}const submitHandler=handleFormSubmit.bind(null,form);form.addEventListener('submit',submitHandler);state.eventListeners.push({element:form,event:'submit',handler:submitHandler});const emailInput=form.querySelector('#email');if(emailInput){const blurHandler=handleEmailBlur.bind(null,emailInput);emailInput.addEventListener('blur',blurHandler);state.eventListeners.push({element:emailInput,event:'blur',handler:blurHandler});const inputHandler=handleEmailInput.bind(null,emailInput);emailInput.addEventListener('input',inputHandler);state.eventListeners.push({element:emailInput,event:'input',handler:inputHandler});}}function handleFormSubmit(form,event){event.preventDefault();clearErrors(form);const emailInput=form.querySelector('#email');const termsCheckbox=form.querySelector('#terms');let isValid=true;if(!emailInput||!validateEmail(emailInput.value)){displayError(emailInput,'Please enter a valid email address');isValid=false;}if(!termsCheckbox||!termsCheckbox.checked){displayError(termsCheckbox,'You must agree to the Terms of Service and Privacy Policy');isValid=false;}if(!isValid){logEvent('form_validation_failed',{timestamp:Date.now()});return;}displaySuccess(form);logEvent('form_submission_success',{timestamp:Date.now()});setTimeout(()=>{form.reset();clearSuccess(form);},5000);}function handleEmailBlur(input){if(input.value&&!validateEmail(input.value)){displayError(input,'Please enter a valid email address');}else{clearFieldError(input);}}function handleEmailInput(input){if(input.value&&validateEmail(input.value)){clearFieldError(input);}}function validateEmail(email){if(!email||typeof email!=='string'){return false;}return CONFIG.EMAIL_REGEX.test(email.trim());}function displayError(field,message){if(!field){return;}clearFieldError(field);const errorElement=document.createElement('span');errorElement.className=CONFIG.ERROR_CLASS;errorElement.textContent=message;errorElement.setAttribute('role','alert');errorElement.setAttribute('aria-live','polite');if(field.type==='checkbox'){const label=field.parentElement;if(label){label.parentElement.insertBefore(errorElement,label.nextSibling);}}else{field.parentElement.appendChild(errorElement);}field.classList.add(CONFIG.ERROR_CLASS);field.setAttribute('aria-invalid','true');}function clearFieldError(field){if(!field){return;}const parent=field.type==='checkbox'?field.parentElement.parentElement:field.parentElement;const errorElement=parent.querySelector(`.${CONFIG.ERROR_CLASS}`);if(errorElement){errorElement.remove();}field.classList.remove(CONFIG.ERROR_CLASS);field.removeAttribute('aria-invalid');}function clearErrors(form){const errorElements=form.querySelectorAll(`.${CONFIG.ERROR_CLASS}`);errorElements.forEach(element=>element.remove());const invalidFields=form.querySelectorAll(`[aria-invalid="true"]`);invalidFields.forEach(field=>{field.classList.remove(CONFIG.ERROR_CLASS);field.removeAttribute('aria-invalid');});}function displaySuccess(form){const successElement=document.createElement('div');successElement.className=CONFIG.SUCCESS_CLASS;successElement.textContent='Thank you! Your account has been created successfully. Check your email for next steps.';successElement.setAttribute('role','status');successElement.setAttribute('aria-live','polite');form.insertBefore(successElement,form.firstChild);successElement.scrollIntoView({behavior:CONFIG.SCROLL_BEHAVIOR,block:'nearest'});}function clearSuccess(form){const successElement=form.querySelector(`.${CONFIG.SUCCESS_CLASS}`);if(successElement){successElement.remove();}}function initAnalytics(){incrementAnalytics('page_views');const clickHandler=handleAnalyticsClick;document.addEventListener('click',clickHandler);state.eventListeners.push({element:document,event:'click',handler:clickHandler});}function handleAnalyticsClick(event){const target=event.target;if(target.matches('.hero__cta-button, .cta__form-button')){const buttonText=target.textContent.trim();logEvent('cta_click',{button:buttonText});incrementAnalytics('cta_clicks');}if(target.matches('.header__menu-link')){const linkText=target.textContent.trim();logEvent('nav_click',{link:linkText});incrementAnalytics('nav_clicks');}}function logEvent(eventName,data){try{const analytics=getAnalytics();if(!analytics.events){analytics.events=[];}analytics.events.push({name:eventName,data:data,timestamp:Date.now()});if(analytics.events.length>100){analytics.events=analytics.events.slice(-100);}saveAnalytics(analytics);}catch(error){console.error('Analytics logging error:',error);}}function incrementAnalytics(key){try{const analytics=getAnalytics();if(!analytics.counters){analytics.counters={};}analytics.counters[key]=(analytics.counters[key]||0)+1;saveAnalytics(analytics);}catch(error){console.error('Analytics increment error:',error);}}function getAnalytics(){try{const data=localStorage.getItem(CONFIG.ANALYTICS_KEY);return data?JSON.parse(data):{};}catch(error){console.error('Analytics retrieval error:',error);return{};}}function saveAnalytics(data){try{localStorage.setItem(CONFIG.ANALYTICS_KEY,JSON.stringify(data));}catch(error){console.error('Analytics save error:',error);}}function cleanup(){state.eventListeners.forEach(({element,event,handler})=>{element.removeEventListener(event,handler);});state.eventListeners=[];}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}window.addEventListener('beforeunload',cleanup);if(typeof window!=='undefined'){window.__fintechCleanup=cleanup;}})();